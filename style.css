:root {
            /* MODULARIZED: Comprehensive control pane spacing variables */
            --control-group-spacing: 15px; /* Standard spacing between control groups */
            --control-picker-gap: 10px; /* Gap after color picker before next title */
            
            /* Section content spacing */
            --section-content-padding: 13px; /* Standard padding for section content */
            --section-content-padding-bottom: 12px; /* Bottom padding for visual equality with borders */
            
            /* FIXED: Button standardization variables */
            --button-standard-height: 37px; /* Standard height for all buttons - matches color inputs and controls */
            --button-standard-padding: 10px; /* Standard vertical padding for buttons */
            --button-standard-font-size: 12px; /* Standard font size for buttons */
            
            /* FIXED: Bottom spacing standardization - VISUAL BALANCE SYSTEM */
            --pane-bottom-spacing: 12px; /* Legacy variable - now using coordinated padding system for visual balance */
            --coordinated-bottom-margin: 3px; /* NEW: Coordinated margin to achieve visual balance (12px padding + 3px margin = 15px total) */
            
            /* Control element spacing within groups */
            --control-element-bottom-margin: 5px; /* Standard bottom margin for inputs, buttons within groups */
            
            /* Button row alignment */
            --button-row-gap: 5px; /* Gap between buttons in button groups */
            
            /* Title to element spacing */
            --title-to-element-spacing: 15px; /* Consistent spacing from titles to first elements */
            
            /* Section header spacing */
            --section-header-to-content-gap: 15px; /* NEW: Gap between section header and first content element */
            
            /* Special preset pane spacing */
            --preset-section-bottom-padding: 15px; /* Consistent with other sections, removing custom 20px */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: white;
            overflow: hidden;
            height: 100vh;
        }

        .container {
            display: flex;
            height: 100vh;
            gap: 10px;
            padding: 10px;
        }

        .viewer-container {
            flex: 1;
            background: #ffffff;
            border-radius: 15px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .controls-panel {
            width: 300px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 15px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            padding: 20px;
            overflow-y: auto;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }

        .panel-title {
            color: #333;
            margin-bottom: 19px; /* 75% of control-section spacing (25px × 0.75 = 18.75px ≈ 19px) */
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .control-section {
            margin-bottom: 25px;
            padding: var(--section-content-padding);
            padding-bottom: var(--section-content-padding-bottom);
            background: rgba(0, 0, 0, 0.03);
            border-radius: 10px;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        /* Legacy h3 styling for non-collapsible sections */
        .control-section h3:not(.section-header h3) {
            color: #333;
            margin-bottom: var(--control-group-spacing);
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .control-group {
            margin-bottom: var(--control-group-spacing);
        }

        /* =====================================================================================
         * UNIVERSAL CONTROL ROW SYSTEM - PHASE 1 MODULARIZATION
         * Eliminates 35+ duplicated CSS rules across 5 button architectures
         * ===================================================================================== */
        
        .control-group-row {
            display: flex;
            gap: 8px;
            align-items: flex-end;
        }

        .control-group-row .control-group {
            flex: 1;
            margin-bottom: 0;
        }

        /* UNIVERSAL PATTERN 1: Color Picker + Button Layout */
        .control-row-color-button {
            display: flex;
            gap: 8px;
            align-items: flex-start;
        }

        .control-row-color-button .color-container {
            flex: 1; /* Color picker takes remaining space */
        }

        .control-row-color-button .color-container label {
            font-size: 12px !important;
            color: #555 !important;
            font-weight: 500 !important;
            margin-bottom: 8px !important; /* FIXED: Increased to match visual spacing of preset labels */
            display: block !important;
        }

        .control-row-color-button .button-container {
            flex: 0 0 80px; /* Button gets fixed 80px width */
        }

        /* UNIVERSAL PATTERN 2: Standard Button Sizing - FIXED for consistent appearance */
        .universal-toggle-button {
            height: 37px !important;
            margin-bottom: 3px !important;
            margin-top: 19px !important;
            width: 100% !important;
            position: relative !important;
            top: -1px !important;
            box-sizing: border-box !important;
            /* CRITICAL FIX: Ensure identical sizing across all state transitions */
            min-width: 80px !important;
            max-width: 80px !important;
            flex-shrink: 0 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        /* UNIVERSAL PATTERN 3: Button State Classes - FIXED for identical sizing */
        .universal-toggle-button.state-primary {
            background: linear-gradient(45deg, rgba(33, 150, 243, 0.8), rgba(25, 118, 210, 0.8)) !important;
            color: white !important;
            /* CRITICAL: Force identical dimensions regardless of content */
            width: 80px !important;
            height: 37px !important;
            line-height: 1 !important;
            font-size: 12px !important;
        }

        .universal-toggle-button.state-secondary {
            background: linear-gradient(45deg, rgba(158, 158, 158, 0.8), rgba(117, 117, 117, 0.8)) !important;
            color: white !important;
            /* CRITICAL: Force identical dimensions regardless of content */
            width: 80px !important;
            height: 37px !important;
            line-height: 1 !important;
            font-size: 12px !important;
        }

        .universal-toggle-button.state-danger {
            background: linear-gradient(45deg, rgba(255, 107, 107, 0.8), rgba(238, 90, 36, 0.8)) !important;
            color: white !important;
            /* CRITICAL: Force identical dimensions regardless of content */
            width: 80px !important;
            height: 37px !important;
            line-height: 1 !important;
            font-size: 12px !important;
        }

        .delete-line {
            margin-left: auto;
        }

        /* Collapsible section styling */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start; /* FIXED: Align icons with top of title text */
            cursor: pointer;
            padding: 0 4px 0 4px; /* FIXED: Minimal padding for click area */
            margin: -2px -4px var(--section-header-to-content-gap) -4px; /* FIXED: Use new variable for proper spacing */
            user-select: none;
            border-radius: 4px;
            transition: background-color 0.2s ease;
        }

        .control-section.collapsed .section-header {
            margin-bottom: 0; /* FIXED: Remove extra spacing when collapsed */
        }

        .section-header:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .section-header:focus {
            outline: 2px solid #4CAF50;
            outline-offset: 2px;
        }

        .section-header h3 {
            margin: 0;
            color: #333;
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
            line-height: 1; /* FIXED: Match collapse icon line-height for perfect alignment */
        }

        .collapse-icon {
            font-size: 16px; /* FIXED: Match title font size for perfect alignment */
            color: #666;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: center;
            margin-left: 8px; /* FIXED: Restore proper horizontal positioning */
            font-weight: bold;
            /* FIXED: Align with top of title text */
            line-height: 1;
            position: relative;
            top: -2px; /* FIXED: Move up to align with title text top */
        }

        .control-section.collapsed .collapse-icon {
            /* Change to downward triangle when collapsed */
        }

        .section-content {
            overflow: hidden;
            transition: max-height 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                        opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                        padding-top 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                        padding-bottom 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .control-section.collapsed .section-content {
            max-height: 0;
            opacity: 0;
            padding-top: 0;
            padding-bottom: 0;
        }

        .control-section:not(.collapsed) .section-content {
            max-height: 1000px;
            opacity: 1;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-group label {
            display: block;
            color: #555;
            margin-bottom: 5px;
            font-size: 12px;
            font-weight: 500;
        }

        /* GUIDE LINE sections: Add spacing above first label after color picker */
        [data-section*="guideline"] .control-row-color-button + .control-group label {
            margin-top: 8px !important; /* FIXED: Match spacing consistency */
        }

        .control-input, .slider-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
            color: #333;
            font-size: 14px;
        }

        .slider-input {
            flex: 1;
        }

        .number-input {
            width: 80px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
            color: #333;
            font-size: 14px;
            text-align: center;
        }

        .control-input:focus, .slider-input:focus, .number-input:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);
            border-color: #007bff;
        }

        .color-input {
            width: 100%;
            height: 37px; /* FIXED: Match button height for consistent alignment */
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        .button {
            width: 100%;
            height: var(--button-standard-height); /* FIXED: Standardize button height globally */
            padding: var(--button-standard-padding); /* FIXED: Use standard padding */
            border: none;
            border-radius: 6px;
            background: linear-gradient(45deg, rgba(255, 107, 107, 0.8), rgba(238, 90, 36, 0.8));
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: var(--button-standard-font-size); /* FIXED: Use standard font size */
            margin-bottom: var(--control-element-bottom-margin);
            /* FIXED: Ensure text is vertically centered */
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            box-sizing: border-box;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .button:active, .button.button-depressed {
            transform: translateY(1px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
        }

        .button:active, .button.button-depressed {
            transform: translateY(1px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
        }

        .button.secondary {
            background: linear-gradient(45deg, rgba(76, 175, 80, 0.8), rgba(69, 160, 73, 0.8));
        }

        .button.secondary:hover {
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .button.button-danger {
            background: linear-gradient(45deg, rgba(255, 107, 107, 0.8), rgba(238, 90, 36, 0.8));
        }

        .button.button-danger:hover {
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .button[disabled] {
            opacity: 0.5;
            cursor: not-allowed;
            background: #cccccc !important;
            box-shadow: none !important;
            transform: none !important;
        }

        .button-group {
            display: flex;
            gap: var(--button-row-gap);
        }
        
        /* FIXED: Ensure buttons in button-groups maintain standard height */
        .button-group .button {
            height: var(--button-standard-height) !important; /* Force standard height for all grouped buttons */
            flex: 1; /* Equal width distribution within groups */
        }

        .preset-name {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
            color: #333;
            font-size: 12px;
        }

        .file-input {
            margin: 10px 0; /* Reduced to minimize internal spacing */
        }

        .file-input input[type="file"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
        }

        .drop-zone {
            border: none; /* REMOVED: Clean padding-only design */
            border-radius: 8px;
            padding: var(--ui-padding-large);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(250, 250, 250, 0.5); /* Even lighter grey for upload area */
            margin: calc(var(--ui-padding-small) + 2px) 0 var(--ui-padding-small) 0;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08); /* Gentle shadow for definition */
        }

        .drop-zone:hover {
            background: rgba(250, 250, 250, 0.7); /* Light grey on hover - no blue */
            transform: translateY(-1px); /* Subtle lift effect */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12); /* Enhanced shadow on hover */
        }

        .drop-zone.dragover {
            background: rgba(250, 250, 250, 0.9); /* Lighter grey on drag over - no blue */
            transform: scale(1.02) translateY(-2px); /* Scale and lift effect */
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15); /* Grey shadow for active state */
        }

        .drop-zone-content {
            pointer-events: none;
        }

        .drop-icon {
            font-size: 32px;
            margin-bottom: 10px;
            opacity: 0.6;
        }

        .drop-text {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }

        .drop-subtext {
            font-size: 12px;
            color: #999;
        }

        .supported-formats {
            font-size: 11px;
            color: #999;
            margin-top: 8px;
            font-style: italic;
        }

        .upload-status {
            font-size: 12px;
            margin-bottom: 20px;
            padding: 8px;
            border-radius: 4px;
            text-align: center;
        }

        .upload-status.success {
            background: rgba(76, 175, 80, 0.1);
            color: #4CAF50;
            border: 1px solid rgba(76, 175, 80, 0.3);
        }

        .upload-status.error {
            background: rgba(244, 67, 54, 0.1);
            color: #f44336;
            border: 1px solid rgba(244, 67, 54, 0.3);
        }

        .upload-status.loading {
            background: rgba(255, 193, 7, 0.1);
            color: #ff9800;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .example-models {
            margin-top: 15px;
        }

        .example-buttons {
            display: flex;
            gap: 5px;
            margin-top: 8px;
        }

        .button.small {
            padding: 6px 10px;
            font-size: 10px;
            flex: 1;
        }

        .info-panel {
            position: absolute;
            top: 10px;
            left: 10px;
            display: flex;
            gap: 10px;
            pointer-events: none; /* Allow interactions to pass through */
        }

        /* Horizontal VIEW layout styling */
        /* Horizontal VIEW layout styling - restored to original */
        .horizontal-view-container {
            display: flex;
            align-items: flex-start;
            gap: 10px; /* Reduced from 20px to free up space for LIGHTING */
            pointer-events: auto;
            margin-top: 10px; /* Align VIEW with LIGHTING vertical position */
        }

        /* 3D Orientation Widget Section - restored */
        .orientation-widget-section {
            display: flex;
            flex-direction: column;
            align-items: flex-start; /* Left-align VIEW title with INTERACTION */
        }
        
        .orientation-widget-section h4 {
            font-size: 12px;
            font-weight: bold;
            color: #555;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 4px; /* Align VIEW title with LIGHTING title baseline */
            margin-left: 15px; /* Match INTERACTION's left padding (15px) */
        }

        /* Square orientation widget box - smaller to match coordinate boxes */
        .orientation-widget-box {
            width: 120px; /* Smaller width to match reduced coordinate boxes */
            height: 120px; /* Square: width x width */
            background: rgba(250, 250, 250, 0.5); /* Same as coordinate boxes */
            display: flex;
            align-items: center;
            justify-content: center;
            border: none; /* Borderless design matching coordinate boxes */
            border-radius: 8px; /* Same as coordinate boxes */
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08); /* Same shadow as coordinate boxes */
            margin-left: 15px; /* Match title alignment */
            margin-top: 7px; /* Align top with coordinate boxes (adjusted by 5px) */
        }
        
        /* Canvas styling within the box */
        .orientation-widget-canvas {
            border-radius: 4px; /* Slightly smaller radius for canvas inside box */
        }

        /* Data columns styling with proper grouping */
        .data-columns-container {
            display: grid;
            grid-template-columns: 1fr 5px 1fr 10px 1fr 5px 1fr;
            align-items: start;
            margin-top: 4px; /* Match VIEW title position to align with LIGHTING baseline */
        }
        
        /* Position columns in the grid with proper spacing */
        .data-columns-container .data-column:nth-child(1) { grid-column: 1; } /* Model Rotation */
        .data-columns-container .data-column:nth-child(2) { grid-column: 3; } /* Model Attitude */  
        .data-columns-container .data-column:nth-child(3) { grid-column: 5; } /* Camera Position */
        .data-columns-container .data-column:nth-child(4) { grid-column: 7; } /* Camera Rotation */

        .data-column {
            display: flex;
            flex-direction: column;
            align-items: stretch;
        }
        
        .data-label {
            color: #333;
            font-size: 10px;
            text-align: center;
            text-transform: uppercase;
            font-weight: bold;
            letter-spacing: 0.5px;
            margin-bottom: 9.5px; /* Compensated to keep boxes in same position */
            margin-top: -1.5px; /* Move titles down 2.5px from previous position */
            padding-top: 3px; /* Subtle adjustment to align text baseline with VIEW/LIGHTING titles */
            font-family: 'Arial', sans-serif;
            /* TODO: Formalize these hardcoded spacing adjustments into calculated values */
        }

        .data-values {
            font-size: 12px;
            color: #555; /* Match LIGHTING and VIEW title color */
            font-weight: normal;
            background: transparent;
            border: none;
            padding: 0;
        }

        /* Coordinate value boxes - fixed size matching widget box */
        .coordinate-value-box {
            font-size: 11px; /* Smaller to fit -180° -180° -180° */
            color: #333;
            font-weight: normal;
            font-family: 'Arial', sans-serif; /* Match rest of tool font */
            background: rgba(250, 250, 250, 0.5); /* Same as sun-control and drop-zone */
            border: none; /* Borderless design matching LIGHTING */
            border-radius: 8px; /* Same as sun-control */
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08); /* Same shadow as LIGHTING boxes */
            padding: 6px; /* Equal padding */
            text-align: center;
            height: 32px; /* Fixed height for consistency */
            width: 120px; /* Fixed width matching widget box */
            display: flex;
            align-items: center; /* Center text vertically */
            justify-content: center; /* Center text horizontally */
            margin-top: 6px; /* Gap below the title */
            box-sizing: border-box; /* Include padding in width calculation */
            margin-left: auto; /* Center the box under the title */
            margin-right: auto; /* Center the box under the title */
            letter-spacing: 0.1px; /* Tight letter spacing for -180° -180° -180° */
            line-height: 1.1; /* Tight line height for centering */
            white-space: nowrap; /* Prevent wrapping of coordinate values */
            overflow: hidden; /* Handle any overflow gracefully */
            font-size: 11px; /* Slightly smaller to fit -180° -180° -180° comfortably */
        }
        
        .info-panel > * {
            pointer-events: auto; /* Re-enable interactions for child elements */
        }

        .info-display {
            background: transparent; /* Boxless design */
            color: #333;
            padding: 15px 15px 7px 15px;
            border-radius: 10px;
            font-family: 'Arial', sans-serif;
            font-size: 12px;
            border: none; /* Boxless design */
            box-shadow: none; /* Boxless design */
        }

        #info {
            width: 315px; /* Adjusted width to prevent label wrapping: 135px label + 15px gap + 160px values = 310px total content, plus padding */
        }

        #instructions {
            width: 300px; /* Wide enough for "F Key: Focus Model on Screen" without wrapping */
        }

        /* Load and Save Panel Styling - matches instructions panel */
        .load-save-display {
            background: rgba(250, 250, 250, 0.5); /* Match instructions panel semi-transparent background */
            border: none; /* Remove border as requested */
            border-radius: 8px; /* Match instructions panel radius */
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08); /* Match instructions panel shadow */
            color: #333;
            font-size: 12px;
            transition: all 0.3s ease;
            overflow: hidden;
            width: calc(var(--right-ui-width) + 20px); /* Expand by 10px on each side */
            margin-left: -10px; /* Shift 10px to the left to keep centered */
            padding: 10px; /* Override info-display padding to be consistent 10px on all sides */
        }

        .load-save-display.collapsed {
            height: 32px; /* Same compact height as instructions */
            position: relative; /* Enable absolute positioning for title */
        }

        .load-save-display.collapsed .load-save-content {
            opacity: 0;
            pointer-events: none;
        }

        .load-save-display:not(.collapsed) .load-save-content {
            opacity: 1;
            padding: 0; /* No padding - content touches panel edges to match external gap spacing */
        }

        .load-save-display.collapsed .load-save-title {
            position: absolute;
            top: 50%;
            left: 10px;
            right: 10px;
            transform: translateY(-50%);
            margin: 0 !important;
            line-height: 1 !important;
            display: block;
        }

        .load-save-title {
            margin: 0;
            padding: 0; /* No padding - content touches panel edges */
            font-size: 12px;
            color: #555;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            line-height: 1.2;
            position: relative;
        }

        .load-save-title .title-hint {
            font-weight: normal;
            color: #999;
            text-transform: none;
            position: absolute;
            left: 132px; /* Moved forward 1px (131px + 1px) */
            top: 50%;
            transform: translateY(-50%);
            width: 150px; /* Wider to prevent wrapping */
        }

        .info-display h4 {
            margin-bottom: 10px;
            font-size: 12px; /* Reduced from 14px to match body text */
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: #555;
        }

        .info-display p {
            margin-bottom: 8px; /* Increased gap between rows */
            line-height: 1.4;
            display: flex;
            align-items: center; /* Vertically center label and boxes */
            gap: 9px; /* Explicit gap between label and content - fixes alignment issues */
            font-size: 12px; /* Ensure consistent text size */
        }

        .info-label {
            display: inline-block;
            width: 135px; /* Further increased width to prevent "Camera Position:" and "Model Rotation:" wrapping */
            font-weight: bold;
            color: #555;
        }

        .info-values-container {
            display: inline-flex;
            align-items: center;
            width: 155px; /* Fixed width for consistent alignment: 3 × 50px + 2 × 2.5px margin = 155px */
        }

        .info-value-box {
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            color: #333;
            padding: 4px 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            font-weight: normal;
            text-align: center;
            width: 50px; /* Fixed width */
            height: 26px; /* Fixed height to match model box */
            margin: 0 2.5px; /* Consistent margin for even gaps: 3*50px + 4*2.5px = 160px (fits in 155px container) */
            box-sizing: border-box;
            line-height: 1.2; /* Consistent line height */
        }

        /* Old .model-name-box style for easy reversion */
        /*
        .model-name-box {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            background: white;
            color: #333;
            padding: 4px 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            font-weight: normal;
            text-align: left;
            height: 26px;
            width: 151px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            box-sizing: border-box;
            line-height: 1.2;
            margin: 0 2px;
        }
        */

        .model-name-box {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            background: white;
            color: #333;
            padding: 4px 6px; /* Match coordinate boxes padding */
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            font-weight: normal;
            text-align: left;
            height: 26px; /* Match coordinate boxes height */
            width: 155px; /* Updated to match new info-values-container width */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            box-sizing: border-box;
            line-height: 1.2; /* Consistent line height */
            margin: 0 2px 0 3px; /* Do not change from 3px (left margin only) as addressed fiddly alignment issue */
        }

        .light-pad {
            position: absolute;
            left: 50%; /* Center horizontally */
            transform: translateX(-50%); /* Perfect centering */
            top: 10px; /* Match other elements' top position */
            width: 128px;
            min-width: 128px;
            max-width: 128px;
            height: 150px;
            flex-shrink: 0;
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            margin-top: 10px;
            /* Position sun control box with 10px gap from right value box (matching button gap) */
            margin-right: 10px;
        }

        .light-icon {
            position: absolute;
            cursor: grab;
            font-size: 20px;
            user-select: none; /* Prevent text selection while dragging */
            transform: translate(-50%, -50%); /* Center the icon on its coordinates */
        }

        .light-icon:active {
            cursor: grabbing;
        }

        .light-icon.flipped {
            transform: translate(-50%, -50%) scaleX(-1);
        }

        .direction-arrow {
            position: absolute;
            user-select: none;
            pointer-events: none;
            display: none; /* Hidden by default, shown only in COMPLEX mode */
            width: 20px;
            height: 20px;
        }

        .direction-arrow svg {
            width: 100%;
            height: 100%;
        }

        .direction-arrow.left-arrow {
            /* Position centered inside left sun icon */
            transform: translate(-50%, -50%);
        }

        .direction-arrow.right-arrow {
            /* Position centered inside right sun icon */
            transform: translate(-50%, -50%);
        }

        /* SUNSET: Greyed out controls styling */
        .sunset-controls {
            opacity: 0.4;
            pointer-events: none;
        }
        
        .sunset-controls label {
            color: #888 !important;
        }
        
        .sunset-controls input,
        .sunset-controls select {
            background-color: #f5f5f5 !important;
            color: #888 !important;
            cursor: not-allowed !important;
        }

        .lighting-controls-container {
            display: flex;
            align-items: flex-start;
            gap: 12px; /* Optimized gap for proper spacing */
            margin-top: 10px;
            justify-content: flex-start; /* Changed from space-between for predictable positioning */
            width: 100%; /* Full container width */
            position: relative;
        }

        .light-slider-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            flex-shrink: 0;
            width: 50px; /* Reduced from 65px for better fit */
            height: 190px;
            margin-top: 10px;
        }
        
        /* RIGHT slider alignment: position at far right of container */
        .light-slider-container.right-slider {
            align-items: flex-end; /* Right-align the slider and value box */
            position: absolute;
            right: 0; /* Position at right edge of container */
            top: 10px; /* Match margin-top */
        }
        
        /* LEFT slider alignment: position at far left of container */
        .light-slider-container.left-slider {
            align-items: flex-start; /* Left-align for mirroring */
            position: absolute;
            left: 0; /* Position at left edge of container */
            top: 10px; /* Match margin-top */
        }
        
        /* Directional light number inputs positioned below sliders with 8px gap */
        .light-slider-container .number-input-small {
            margin-top: 8px;
            width: 45px;
            text-align: center;
        }

        .vertical-slider {
            writing-mode: vertical-lr;
            direction: rtl;
            width: 20px;
            height: 150px;
            background: rgba(0, 0, 0, 0.1);
            outline: none;
            opacity: 0.7;
            transition: opacity 0.2s;
            border-radius: 10px;
        }

        .vertical-slider:hover {
            opacity: 1;
        }

        .vertical-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
        }

        .vertical-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
            border: none;
        }

        .slider-label {
            font-size: 10px;
            color: #666;
            margin-top: 0;
            margin-bottom: 5px;
            order: -1;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .ambient-light-controls {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            /* AMBIENT LIGHT divider: extend from left value box to right value box */
            position: relative;
        }
        
        /* Extend the ambient light divider line to match slider span */
        .ambient-light-controls::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: rgba(0, 0, 0, 0.1);
            /* Align with the outer edges of the slider containers */
        }

        .ambient-label {
            display: block;
            font-size: 10px;
            color: #666;
            margin-bottom: 8px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .ambient-slider-container {
            display: flex;
            align-items: center;
            gap: 8px;
            /* Align with the slider container positions for proper span */
            width: 100%;
            /* Ensure it spans from left value box to right value box */
            justify-content: space-between;
            padding: 0; /* No additional padding - use full width */
        }

        .horizontal-slider {
            flex: 1; /* Take available space between left and right boundaries */
            padding: 0;
            height: 20px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.1);
            outline: none;
            opacity: 0.7;
            transition: opacity 0.2s;
            /* Ensure slider spans from left value box to right value box area */
            min-width: 150px;
        }

        .horizontal-slider:hover {
            opacity: 1;
        }

        .horizontal-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
        }

        .horizontal-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
            border: none;
        }

        .number-input-small {
            width: 50px;
            padding: 4px 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            color: #333;
            font-size: 10px;
            text-align: center;
        }

        .corner-label {
            position: absolute;
            font-size: 10px;
            color: #666;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            bottom: 10px;
        }

        .left-label {
            left: 10px;
        }

        .right-label {
            right: 10px;
        }

        .title-container {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            margin-bottom: 10px;
            /* Make it span full width of parent including padding */
            width: calc(100% + 30px); /* 100% of content area + 15px left + 15px right padding */
            margin-left: -15px; /* Pull it left by parent's left padding */
            padding: 0 15px; /* Add back padding to its own content */
            position: relative;
        }

        .title-container h4 {
            margin: 0;
        }

        /* OLD BUTTON POSITIONING RULES REMOVED - CONFLICTED WITH NEW CLEAN LAYOUT */

         .guide-line-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none; /* Allow clicks to pass through to the canvas */
            z-index: 1; /* Behind UI elements (z-index: 10) but above canvas */
        }

        .guide-line {
            position: absolute;
            top: 0; /* Controlled by JS */
            left: 0;
            width: 100%;
            height: 5px; /* Default thickness */
            background-color: #FFFF00; /* Default yellow color - will be overridden by JS */
            transform-origin: 50% 50%; /* Always rotate from the true center of the element */
            z-index: 1; /* Behind UI elements (z-index: 10) but above canvas */
        }

        /* Collapsible instructions panel */
        .instructions-display {
            position: absolute;
            bottom: 10px;
            left: 10px;
            width: 180px; /* Much smaller to test if changes are applying */
            z-index: 10;
            background: rgba(250, 250, 250, 0.5); /* Transparent background like other panels */
            border: none;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            overflow: hidden;
            cursor: pointer;
            user-select: none;
            padding: 0;
        }
        
        .instructions-display.collapsed {
            height: 32px; /* Compact collapsed height with equal padding */
        }
        
        .instructions-display.collapsed .instructions-title {
            display: flex;
            align-items: center; /* Center text vertically when collapsed */
            height: 32px;
            padding: 0 10px; /* No vertical padding when using flexbox centering */
        }
        
        .instructions-display:not(.collapsed) {
            max-height: 300px; /* Enough for all instructions */
        }
        
        .instructions-display.collapsed .interaction-table {
            opacity: 0;
            pointer-events: none;
        }
        
        .instructions-display:not(.collapsed) .interaction-table {
            opacity: 1;
            padding: 0 10px 2px 10px; /* Minimal bottom padding for tight spacing */
        }
        
        .instructions-title {
            margin: 0;
            padding: 8px 10px; /* Reduced vertical padding for compact collapsed state */
            font-size: 12px;
            color: #555;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            line-height: 1.2; /* Tighter line height */
            position: relative;
        }
        
        .title-main {
            font-weight: bold;
        }
        
        .title-hint {
            font-weight: normal;
            color: #999;
            text-transform: none; /* Override uppercase from parent */
            position: absolute;
            left: 159px; /* Adjusted to better align with action text column */
            top: 50%;
            transform: translateY(-50%); /* Center vertically */
        }
        
        .instructions-display p {
            margin-bottom: 5px;
            line-height: 1.4;
        }
        
        #light-controls {
            /* MIGRATED TO MASTER GRID: Positioning now handled by .lighting-grid-area */
            /* position: absolute;
            top: 10px;
            right: 16px;
            width: 290px;
            z-index: 10; */
            position: relative; /* Grid child positioning */
            width: 100%; /* Fill grid area */
        }
        
        /* LIGHTING title alignment: align to left edge of pane */
        #light-controls .title-container {
            /* Title container already spans full width and aligns left */
            /* No additional changes needed - current positioning is correct */
        }
        
        /* Fine-tune the overall layout to achieve precise alignment */
        #light-controls .lighting-controls-container {
            /* Remove padding to use full container width for proper alignment */
            padding: 0; /* No padding - use full width */
            /* Container spans full 290px width with absolute positioned elements */
            /* Left slider: 0px, Sun pad: centered, Right slider: 290px-50px = 240px */
            width: 100%; /* Use full container width */
            height: 200px; /* Set explicit height for absolute positioned children */
            max-width: 270px; /* Constrain to prevent overflow */
        }

        /* Responsive positioning for different screen sizes */
        @media (max-width: 1200px) {
            .instructions-display {
                width: 170px; /* Much smaller to test */
                font-size: 11px;
            }
            
            #light-controls {
                width: 290px;
                font-size: 11px;
            }
        }

        @media (max-width: 768px) {
            .instructions-display {
                bottom: 10px;
                left: 10px;
                width: 160px; /* Much smaller to test */
                font-size: 10px;
                padding: 10px;
            }
            
            #light-controls {
                /* REMOVED: Old absolute positioning conflicts with new grid layout */
                width: 290px;
                font-size: 10px;
                padding: 10px;
            }
            
            .info-panel {
                top: 10px;
                left: 10px;
            }
        }

        @media (max-width: 480px) {
            .instructions-display {
                width: calc(100vw - 300px - 40px); /* Account for controls panel width */
                min-width: 180px;
            }
            
            #light-controls {
                width: calc(100vw - 300px - 40px);
                min-width: 290px;
            }
        }

        .line-controls-panel {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.05);
            color: #333;
            padding: 15px 15px 7px 15px;
            border-radius: 10px;
            font-family: 'Arial', sans-serif;
            font-size: 12px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            width: 250px;
        }

        /* Upload area styling */
        .upload-area {
            /* MIGRATED TO MASTER GRID: Positioning now handled by .upload-grid-area */
            /* position: absolute;
            bottom: 10px;
            right: 10px;
            width: 230px;
            z-index: 10; */
            position: relative; /* Grid child positioning */
            width: 100%; /* Fill grid area */
            background: transparent; /* Boxless design */
            color: #333;
            padding: 0; /* Remove padding since now handled by collapsible panel */
            border-radius: 10px;
            font-family: 'Arial', sans-serif;
            font-size: 12px;
            border: none; /* Boxless design */
            box-shadow: none; /* Boxless design */
        }

        /* SUNSET: Model buttons CSS (TORUS and LIBRARY buttons removed) */
        /* .model-buttons {
            display: flex;
            gap: var(--button-row-gap);
            margin-bottom: 10px;
        }

        .model-buttons .button {
            flex: 1;
        } */

        /* Bottom buttons - mirror top buttons with equivalent gap above */
        .model-buttons-bottom {
            display: flex;
            gap: var(--button-row-gap); /* Same gap as top buttons */
            margin-top: 10px; /* Reduced to minimize internal spacing */
            margin-bottom: 0; /* Remove bottom margin */
        }

        .model-buttons-bottom .button {
            flex: 1;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #333;
            font-size: 18px;
            text-align: center;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-top: 4px solid #333;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        canvas {
            display: block;
            border-radius: 15px;
            width: 100% !important;
            height: 100% !important;
        }

        /* INTERACTION table styling */
        .interaction-table {
            /* Container for interaction instructions */
        }

        .interaction-row {
            margin-bottom: 8px; /* Spacing between lines */
            line-height: 1.4;
            display: flex;
            align-items: baseline;
            gap: 9px; /* Explicit gap between label and action */
        }

        .interaction-label {
            display: inline-block;
            width: 140px; /* Fixed width for labels to align with "Right-click and Drag:" */
            flex-shrink: 0; /* Prevent shrinking */
            font-size: 12px; /* Ensure consistent text size */
        }

        .interaction-action {
            flex: 1; /* Take remaining space */
            margin-left: 0; /* No extra margin since flex gap handles spacing */
            font-size: 12px; /* Ensure consistent text size */
        }

        /* Checkbox styles for surface extraction controls */
        .checkbox-input {
            margin-right: 8px;
            transform: scale(1.2);
            cursor: pointer;
        }

        .checkbox-input + label {
            cursor: pointer;
            font-size: 12px;
            user-select: none;
        }

        /* GUIDE LINE SECTIONS: Now use Universal Control Row System */
        /* Old .control-group-row rules removed - now using .control-row-color-button */

        /* Guide line color input styling - FIXED to match MATERIALS appearance */
        [data-section*="guideline"] .color-input {
            width: 100%;
            height: 37px; /* Match MATERIALS height */
            border: 1px solid #ddd; /* Match MATERIALS border */
            border-radius: 6px;
            cursor: pointer;
            padding: 0;
            box-sizing: border-box;
            margin-bottom: 5px;
            position: relative;
            top: -1px; /* Match MATERIALS positioning */
        }

        /* HIDE/UNHIDE button - FIXED: Apply same positioning as MATERIALS button */
        [data-section*="guideline"] #hideUnhideGuide {
            height: 37px !important; /* Match button standard height */
            margin-bottom: 5px !important; /* Match color input margin */
            margin-top: 22px !important; /* FIXED: Align button top with color input top (12px font + 1.2 line-height + 8px margin = ~22px) */
            width: 100% !important;
            position: relative !important;
            top: -1px !important; /* Match color input positioning */
            box-sizing: border-box !important;
        }

        /* HIDE state - blue button with blue glow */
        [data-section*="guideline"] #hideUnhideGuide.secondary {
            background: linear-gradient(45deg, rgba(33, 150, 243, 0.8), rgba(25, 118, 210, 0.8)) !important;
        }

        [data-section*="guideline"] #hideUnhideGuide.secondary:hover {
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.4) !important; /* Blue glow */
        }

        /* UNHIDE state - red button with red glow */
        [data-section*="guideline"] #hideUnhideGuide.button-danger {
            background: linear-gradient(45deg, rgba(255, 107, 107, 0.8), rgba(238, 90, 36, 0.8)) !important;
        }

        [data-section*="guideline"] #hideUnhideGuide.button-danger:hover {
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4) !important; /* Red glow */
        }

        /* Bottom button styling for guide lines - FIXED: Use coordinated padding system */
        .guide-line-bottom-button {
            margin-top: 0px !important; /* Remove extra margin */
            margin-bottom: var(--coordinated-bottom-margin) !important; /* FIXED: Use coordinated padding system */
        }

        .guide-line-bottom-button .button {
            width: 100%; /* Full width for default pane */
            margin-bottom: 0px !important; /* FIXED: No additional margin, let parent handle spacing */
        }

        .guide-line-bottom-buttons {
            margin-top: 0px !important; /* Remove extra margin */
            margin-bottom: var(--coordinated-bottom-margin) !important; /* FIXED: Use coordinated padding system */
        }

        .guide-line-bottom-buttons .button-group {
            display: flex;
            gap: var(--button-row-gap); /* Standardized button gap */
            margin-bottom: 0px !important; /* FIXED: No additional margin, parent container handles spacing */
        }

        .guide-line-bottom-buttons .button {
            flex: 1; /* Equal width for both buttons */
            margin-bottom: 0px !important; /* FIXED: No additional margin, let parent handle spacing */
        }

        /* Ensure ADD LINE button in additional panes is green (secondary) */
        .guide-line-bottom-buttons .add-line-below {
            background: linear-gradient(45deg, rgba(76, 175, 80, 0.8), rgba(69, 160, 73, 0.8)) !important;
        }

        .guide-line-bottom-buttons .add-line-below:hover {
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4) !important;
        }

        /* Ensure REMOVE LINE button is red (danger) */
        .guide-line-bottom-buttons .remove-line {
            background: linear-gradient(45deg, rgba(255, 107, 107, 0.8), rgba(238, 90, 36, 0.8)) !important;
        }

        .guide-line-bottom-buttons .remove-line:hover {
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4) !important;
        }


        /* Material control alignment - REMOVED: Conflicting rules that break button sizing */
        /* These were backwards - color input should flex: 1, button should be fixed width */

        /* MATERIAL SECTION: Simplified - Universal System handles layout */
        [data-section="material"] .color-input {
            height: 37px;
            border: 1px solid #ddd;
            padding: 0;
            box-sizing: border-box;
            margin-bottom: 5px;
            position: relative;
            top: -1px;
        }

        /* Move Metalness controls down by consistent gap */
        [data-section="material"] .control-group:has(#metalness, .metalness),
        [data-section="material"] .control-group:has(#metalness, .metalness) ~ .control-group {
            margin-top: var(--control-picker-gap);
        }


        /* Additional guide line panes HIDE/UNHIDE button - FIXED: Apply same positioning as default guide line */
        [data-section="guideline-added"] .hide-unhide-guide {
            height: 37px !important; /* Match button standard height */
            margin-bottom: 5px !important; /* Match color input margin */
            margin-top: 22px !important; /* FIXED: Align button top with color input top (12px font + 1.2 line-height + 8px margin = ~22px) */
            width: 100% !important;
            position: relative !important;
            top: -1px !important; /* Match color input positioning */
            box-sizing: border-box !important;
        }

        /* MATERIALS COMPLEX/BASIC button - FIXED: Apply same positioning as guide line buttons */
        [data-section="material"] #complexMaterialButton {
            margin-top: 22px !important; /* FIXED: Align button top with color input top (12px font + 1.2 line-height + 8px margin = ~22px) */
            margin-bottom: 5px !important; /* Match color input margin */
        }

        /* 3D Orientation Widget - rendered directly on canvas */
        /* Widget positioning handled via Three.js viewport, no CSS needed */

        /* Additional panes HIDE state - blue button with blue glow */
        [data-section="guideline-added"] .hide-unhide-guide.secondary {
            background: linear-gradient(45deg, rgba(33, 150, 243, 0.8), rgba(25, 118, 210, 0.8)) !important;
        }

        [data-section="guideline-added"] .hide-unhide-guide.secondary:hover {
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.4) !important;
        }

        /* Additional panes UNHIDE state - red button with red glow */
        [data-section="guideline-added"] .hide-unhide-guide.button-danger {
            background: linear-gradient(45deg, rgba(255, 107, 107, 0.8), rgba(238, 90, 36, 0.8)) !important;
        }

        [data-section="guideline-added"] .hide-unhide-guide.button-danger:hover {
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4) !important;
        }

        /* ADDITIONAL GUIDE LINE PANES: Now use Universal Control Row System */
        /* Old .control-group-row rules removed - now using .control-row-color-button */

        /* Guide line styling - standard layout since buttons are no longer universal */

        /* Default pane HIDE/UNHIDE button - restored to standard styling */
        [data-section="guideline"] #hideUnhideGuide {
            /* Standard button styling ensures proper getBoundingClientRect() positioning */
        }

        [data-section="guideline"] #hideUnhideGuide.secondary {
            background: linear-gradient(45deg, rgba(33, 150, 243, 0.8), rgba(25, 118, 210, 0.8)) !important;
        }

        [data-section="guideline"] #hideUnhideGuide.secondary:hover {
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.4) !important;
        }

        [data-section="guideline"] #hideUnhideGuide.button-danger {
            background: linear-gradient(45deg, rgba(255, 107, 107, 0.8), rgba(238, 90, 36, 0.8)) !important;
        }

        [data-section="guideline"] #hideUnhideGuide.button-danger:hover {
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4) !important;
        }

        /* MATERIAL SECTION: Now using Universal Control Row System */
        /* All button sizing and layout handled by .control-row-color-button and .universal-toggle-button classes */

        /* Add bottom border to all control sections */
        .control-section {
            border-bottom: 2px solid rgba(0, 0, 0, 0.1) !important;
        }

        /* SUNSET: Disable all button hover glow effects in CONTROLS */
        .controls-panel .button:hover,
        .controls-panel .button.secondary:hover,
        .controls-panel .button.button-danger:hover,
        .controls-panel #hideUnhideGuide:hover,
        .controls-panel .hide-unhide-guide:hover,
        .controls-panel .add-line-below:hover,
        .controls-panel .remove-line:hover,
        [data-section="guideline"] #hideUnhideGuide.secondary:hover,
        [data-section="guideline"] #hideUnhideGuide.button-danger:hover,
        [data-section="guideline-added"] .hide-unhide-guide.secondary:hover,
        [data-section="guideline-added"] .hide-unhide-guide.button-danger:hover {
            box-shadow: none !important;
            /* Keep the translateY effect but remove glow */
            transform: translateY(-2px);
        }

        /* Remove hover glow effects from all buttons in the main pane */
        .upload-area .button:hover,
        .upload-area .button.secondary:hover,
        .upload-area .button.button-danger:hover {
            box-shadow: none !important;
            /* Keep the translateY effect but remove glow */
            transform: translateY(-2px);
        }

        /* Remove bottom margin from all buttons in the LOAD AND SAVE panel */
        .upload-area .button {
            margin-bottom: 0 !important;
        }

        /* =====================================================================================
         * COORDINATED PADDING SYSTEM - VISUAL BALANCE FOR ALL CONTROL PANES
         * =====================================================================================
         *
         * PROBLEM SOLVED: Eliminated competing padding rules that created visual imbalance
         * 
         * OLD SYSTEM (Unbalanced):
         * - Horizontal gaps: 15px each side (from --section-content-padding)
         * - Bottom gap: 24px (12px section padding + 12px pane spacing)
         * - Result: Bottom gap was 60% larger than horizontal gaps
         *
         * NEW COORDINATED SYSTEM (Balanced):
         * - Horizontal gaps: 15px each side (unchanged)
         * - Bottom gap: 15px total (12px section padding + 3px element margin)
         * - Result: ALL gaps around button groups are equal = PERFECT VISUAL BALANCE
         *
         * IMPLEMENTATION:
         * - All final elements use: margin-bottom: 3px !important
         * - Combined with section-content-padding-bottom (12px) = 15px total
         * - Matches horizontal --section-content-padding (15px)
         * ===================================================================================== */
        
        /* CAPTURE pane - FIXED: Eliminate competing padding rules for perfect visual balance */
        [data-section="capture"] .button-group:last-child {
            margin-bottom: 0px !important; /* Remove margin from button group */
        }
        
        /* CAPTURE pane buttons - FIXED: Apply coordinated margin to buttons inside last button group */
        [data-section="capture"] .button-group:last-child .button {
            margin-bottom: var(--coordinated-bottom-margin) !important; /* FIXED: Coordinated padding system for visual balance */
        }
        
        /* GUIDE LINE pane - CLEANED: Duplicate rule removed, handled by general .guide-line-bottom-button rule above */
        
        /* CAMERA pane - FIXED: Apply coordinated padding system for visual balance */
        [data-section="camera"] #resetCamera {
            margin-bottom: var(--coordinated-bottom-margin) !important; /* FIXED: Coordinated padding system for visual balance */
            margin-top: var(--control-group-spacing); /* Maintain spacing above button */
        }
        
        /* OVERRIDE: Ensure camera button wins over generic .button margin rule */
        [data-section="camera"] .button#resetCamera {
            margin-bottom: var(--coordinated-bottom-margin) !important; /* FORCE: Higher specificity override */
        }
        
        /* MODEL pane - FIXED: Apply coordinated padding system for visual balance */
        [data-section="model"] #resetModel {
            margin-bottom: var(--coordinated-bottom-margin) !important; /* FIXED: Coordinated padding system for visual balance */
            margin-top: var(--control-group-spacing); /* Maintain spacing above button */
        }
        
        /* OVERRIDE: Ensure model button wins over generic .button margin rule */
        [data-section="model"] .button#resetModel {
            margin-bottom: var(--coordinated-bottom-margin) !important; /* FORCE: Higher specificity override */
        }
        
        /* MATERIAL pane - FIXED: Apply coordinated padding system for visual balance */
        [data-section="material"] .control-group:last-child {
            margin-bottom: var(--coordinated-bottom-margin) !important; /* FIXED: Coordinated padding system for visual balance */
        }
        
        /* OVERRIDE: Ensure material pane transparency controls use coordinated system regardless of element type */
        [data-section="material"] .control-group:last-child .slider-container {
            margin-bottom: 0 !important; /* Remove any competing margin from slider container */
        }
        
        [data-section="material"] .control-group:last-child .number-input {
            margin-bottom: 0 !important; /* Remove any competing margin from number input */
        }
        
        [data-section="material"] .control-group:last-child .control-input {
            margin-bottom: 0 !important; /* Remove any competing margin from dropdown in COMPLEX mode */
        }
        
        /* FORCE: High specificity override to ensure material pane final element uses coordinated system */
        [data-section="material"] .section-content > .control-group:last-child {
            margin-bottom: var(--coordinated-bottom-margin) !important; /* 3px coordinated margin */
        }
        
        /* ROBUST FIX: Use multiple selector approaches for maximum compatibility */
        
        /* Method 1: Target the transparency slider control group specifically */
        [data-section="material"] .control-group:nth-of-type(3),
        [data-section="material"] .control-group:nth-of-type(4) {
            margin-bottom: var(--coordinated-bottom-margin) !important; /* Target transparency controls by type position */
        }
        
        /* Method 2: Target by containing specific elements (if supported) */
        [data-section="material"] .control-group:has(#transparency),
        [data-section="material"] .control-group:has(#transparencyMode) {
            margin-bottom: var(--coordinated-bottom-margin) !important; /* Target by contained elements */
        }
        
        /* Method 3: Fallback - override the base control-group margin for final elements only */
        [data-section="material"] .section-content > .control-group:nth-last-child(1),
        [data-section="material"] .section-content > .control-group:nth-last-child(2) {
            margin-bottom: var(--coordinated-bottom-margin) !important; /* Force last and second-to-last to use coordinated margin */
        }
        
        /* DOCUMENTATION: Element height analysis for material pane final elements
         * - Button height: 37px (via --button-standard-height)
         * - Number input height: ~34-36px (8px top + 8px bottom padding + font height + borders)
         * - Select dropdown height: Similar to number input
         * NOTE: Height differences are minimal and intentionally preserved per requirements
         */
        
        /* PRESETS pane - FIXED: Apply coordinated padding system for visual balance */
        [data-section="presets"] .control-group:has(#presetSelector) {
            margin-top: var(--title-to-element-spacing); /* FIXED: Match spacing between title and SAVE button */
            margin-bottom: var(--coordinated-bottom-margin) !important; /* FIXED: Coordinated padding system for visual balance */
        }
        
        /* Additional guide line panes - CLEANED: Duplicate rule removed, handled above */
        
        /* =====================================================================================
         * GLOBAL SAFETY RULE: ENSURE ALL FINAL BUTTONS USE COORDINATED MARGIN SYSTEM
         * =====================================================================================
         * This rule acts as a safety net to ensure any button that is the last child
         * in a control section gets the coordinated margin, preventing future regressions.
         * More specific rules above will override this when needed.
         * ===================================================================================== */
        
        /* Apply coordinated margin to any button that is the final element in a section */
        .control-section .section-content > *:last-child .button:last-child,
        .control-section .section-content > .button:last-child {
            margin-bottom: var(--coordinated-bottom-margin) !important; /* SAFETY: Global coordinated margin for final buttons */
        }

        /* =============================================================================
         * MASTER RIGHT-UI GRID ARCHITECTURE SYSTEM
         * Unified grid system for LIGHTING + Upload area perfect alignment
         * =============================================================================
         */

        /* Master grid container for right-side UI elements */
        .right-ui-grid {
            position: absolute;
            top: 10px;
            right: 21px; /* Moved back another 1px for better gap alignment */
            bottom: 10px;
            width: var(--right-ui-width);
            display: grid;
            grid-template-rows: auto 1fr auto;
            grid-template-areas:
                "lighting"
                "spacer"
                "upload";
            gap: var(--right-ui-gap);
            pointer-events: none; /* Allow clicks through to model */
            z-index: 10;
        }

        /* Grid area wrappers */
        .lighting-grid-area {
            grid-area: lighting;
            pointer-events: auto;
            padding: 0 0 var(--ui-padding-large) 0; /* Spacing between sections */
            margin-right: 0; /* Reset margin since moving entire container */
            margin-top: -2px; /* Move lighting controls 2px up */
        }

        .upload-grid-area {
            grid-area: upload;
            pointer-events: auto;
            padding: 0; /* Pure content positioning */
            margin-right: 0; /* Remove right margin to align with grid positioning */
        }

        /* =============================================================================
         * CLEAN LIGHTING CONTROLS SYSTEM
         * Simplified layout aligned with VIEW titles and upload area
         * =============================================================================
         */

        /* Clean LIGHTING Controls - Aligned with VIEW titles */
        .lighting-section {
            width: var(--right-ui-width);
            padding: 0;
            position: relative;
        }

        /* Header with title and buttons - Aligned to VIEW baseline */
        .lighting-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 15px;
            margin-top: 14px; /* Align LIGHTING title with VIEW titles */
        }

        .lighting-title {
            font-size: 12px;
            font-weight: bold;
            color: #555;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 0;
        }

        .lighting-buttons {
            display: flex;
            gap: 8px;
        }

        /* Cache-bust: 2025-08-13T14:30:00Z - Fixed inline style override issue */
        .mode-button {
            display: inline-block;
            padding: 3px 8px 3px 8px;
            font-size: 10px;
            font-weight: 600;
            border: none;
            border-radius: 6px;
            background: linear-gradient(45deg, rgba(158, 158, 158, 0.8), rgba(117, 117, 117, 0.8)) !important;
            color: white;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            line-height: 1;
        }

        .mode-button.active {
            background: linear-gradient(45deg, rgba(76, 175, 80, 0.8), rgba(69, 160, 73, 0.8)) !important;
        }

        .mode-button:hover {
            transform: translateY(-1px);
        }

        /* Main controls row */
        .lighting-controls {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        /* Slider groups (left and right) */
        .slider-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .vertical-slider {
            width: 20px;
            height: 120px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            writing-mode: vertical-lr;
            direction: rtl;
            outline: none;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .vertical-slider:hover {
            opacity: 1;
        }

        .vertical-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
        }

        .vertical-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
            border: none;
        }

        .slider-value {
            width: 45px;
            margin-top: 8px;
            padding: 4px;
            text-align: center;
            font-size: 11px;
            border: none;
            border-radius: 8px;
            background: rgba(250, 250, 250, 0.5);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
        }

        /* Sun control center */
        .sun-control {
            width: 128px;
            height: 120px;
            background: rgba(250, 250, 250, 0.5); /* Same light grey as upload area */
            border: none; /* No border like upload area */
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            padding: 0 15px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08); /* Same shadow as upload area */
        }

        .sun-icon {
            font-size: 20px;
            margin: 0;
            position: absolute;
        }


        /* Ambient light controls */
        .ambient-label {
            font-size: 10px;
            font-weight: bold;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
            margin-top: 8px;
        }

        .ambient-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .horizontal-slider {
            flex: 1;
            height: 20px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            outline: none;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .horizontal-slider:hover {
            opacity: 1;
        }

        .horizontal-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
        }

        .horizontal-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
            border: none;
        }

        /* =============================================================================
         * MODULAR LIGHTING GRID ARCHITECTURE SYSTEM (LEGACY - FOR REFERENCE)
         * Professional CSS Grid layout with mathematical precision
         * =============================================================================
         */

        :root {
            /* === MASTER GRID ARCHITECTURE SYSTEM === */
            /* Universal spacing - padding only, no margins/borders */
            --ui-padding-large: 20px;   /* Between major sections */
            --ui-padding-medium: 15px;  /* Within sections */
            --ui-padding-small: 10px;   /* Between controls */
            --ui-padding-tiny: 5px;     /* Within controls */
            
            /* Right UI grid dimensions */
            --right-ui-width: 260px;    /* INCREASED: Allow wider grid for perfect alignment */
            --right-ui-gap: 0px;        /* No gaps - pure padding spacing */
            
            /* === LIGHTING PANEL GRID SYSTEM === */
            /* RESPONSIVE: Now based on master grid width instead of fixed values */
            --lighting-panel-width: var(--right-ui-width); /* Use master grid width */
            --lighting-panel-padding: var(--ui-padding-medium); /* Use consistent padding */
            --lighting-content-width: calc(var(--lighting-panel-width) - (var(--lighting-panel-padding) * 2));
            
            /* Grid measurements */
            --slider-width: 20px;
            --value-box-width: 45px;
            --sun-control-width: 128px;
            --outer-margin: 15px; /* NEW: Inset margin for slider positioning */
            --button-gap: 7.5px; /* REDUCED: Gap reduction by 0.75 factor (10px * 0.75 = 7.5px) */
            
            /* Button dimensions */
            --basic-button-width: 58px;
            --complex-button-width: 68px;
            
            /* Calculated grid points - Mathematical precision */
            --grid-left-edge: var(--outer-margin); /* UPDATED: Start after outer margin */
            --grid-left-value-start: var(--grid-left-edge);
            --grid-left-value-end: calc(var(--grid-left-value-start) + var(--value-box-width));
            
            --grid-basic-button-right: calc(var(--lighting-content-width) - var(--outer-margin)); /* UPDATED: Account for right outer margin */
            --grid-basic-button-left: calc(var(--grid-basic-button-right) - var(--basic-button-width));
            
            /* MASTER GRID ALIGNMENT: Right value box aligns with upload area content right edge */
            /* Now that both elements are in master grid, use coordinated positioning */
            --upload-content-padding: var(--ui-padding-medium); /* Upload area internal padding */
            --alignment-target: calc(var(--right-ui-width) - var(--upload-content-padding)); /* Right edge of upload content */
            --grid-right-value-end: var(--alignment-target);
            --grid-right-value-start: calc(var(--grid-right-value-end) - var(--value-box-width));
            
            /* REDUCED: Sun control gaps by 0.75 factor for tighter layout */
            --grid-sun-gap-reduction: calc(var(--sun-control-width) * 0.25 / 2); /* 25% reduction split between both sides */
            --grid-sun-center: calc((var(--grid-left-value-end) + var(--grid-right-value-start)) / 2);
            --grid-sun-start: calc(var(--grid-sun-center) - (var(--sun-control-width) / 2) + var(--grid-sun-gap-reduction));
            --grid-sun-end: calc(var(--grid-sun-center) + (var(--sun-control-width) / 2) - var(--grid-sun-gap-reduction));
            
            --grid-complex-button-right: calc(var(--grid-basic-button-left) - var(--button-gap));
            --grid-complex-button-left: calc(var(--grid-complex-button-right) - var(--complex-button-width));
        }

        /* Main lighting grid container */
        .lighting-grid-container {
            display: grid;
            width: 100%;
            grid-template-columns: 
                [panel-start] var(--outer-margin)
                [title-start left-value-start] var(--value-box-width)
                [left-value-end left-gap-start] 1fr
                [left-gap-end sun-start] var(--sun-control-width)
                [sun-end right-gap-start] 1fr  
                [right-gap-end right-value-start] var(--value-box-width)
                [right-value-end] 1fr /* FLEXIBLE: Allow grid to extend as needed for alignment */
                [basic-button-end panel-end];
            grid-template-rows: 
                [title-row] auto
                [controls-row] auto
                [ambient-row] auto;
            gap: 10px 0;
            position: relative;
        }

        /* Title row with button positioning */
        .lighting-title-row {
            grid-column: panel-start / panel-end;
            grid-row: title-row;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
        }

        .lighting-title {
            margin: 0;
            font-size: 12px;
            color: #555;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .lighting-buttons-container {
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: var(--button-gap);
            align-items: center;
            /* FIXED: Ensure buttons vertically align with LIGHTING title center */
            line-height: 1;
        }

        /* Main controls row */
        .lighting-controls-row {
            grid-column: panel-start / panel-end;
            grid-row: controls-row;
            display: contents;
        }

        /* Left slider positioned at left value area */
        .lighting-left-slider {
            grid-column: left-value-start / left-value-end;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-self: start;
        }

        /* Sun control perfectly centered */
        .lighting-sun-control {
            grid-column: sun-start / sun-end;
            justify-self: center;
            align-self: start;
            position: relative;
            width: var(--sun-control-width);
            height: 150px;
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        /* Right slider - PERFECT ALIGNMENT WITH UPLOAD AREA */
        .lighting-right-slider {
            grid-column: right-value-start / right-value-end;
            display: flex;
            flex-direction: column;
            align-items: flex-end; /* Align to right edge of value box */
            justify-self: end; /* Position at right edge of grid area */
            /* CLEAN: No background, pure padding-only design */
            padding: var(--ui-padding-tiny);
        }

        /* Ambient light spans from left value box to right value box */
        .lighting-ambient-row {
            grid-column: left-value-start / right-value-end;
            grid-row: ambient-row;
            margin-top: 15px;
            padding-top: 15px;
            /* border-top: 1px solid rgba(0, 0, 0, 0.1); REMOVED: No border line above ambient light */
        }

        .lighting-ambient-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
        }

        .lighting-ambient-label {
            font-size: 10px;
            color: #666;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            flex-shrink: 0;
        }

        .lighting-ambient-slider {
            flex: 1;
        }

        /* =============================================================================
         * REUSABLE COMPONENT STYLES
         * =============================================================================
         */

        /* Vertical slider styling (reusable) */
        .grid-vertical-slider {
            writing-mode: vertical-lr;
            direction: rtl;
            width: var(--slider-width);
            height: 150px;
            background: rgba(0, 0, 0, 0.1);
            outline: none;
            opacity: 0.7;
            transition: opacity 0.2s;
            border-radius: 10px;
        }

        .grid-vertical-slider:hover {
            opacity: 1;
        }

        .grid-vertical-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
        }

        .grid-vertical-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #007bff;
            cursor: pointer;
            border: none;
        }

        /* Value box styling (reusable) - BORDERLESS DESIGN */
        .grid-value-box {
            width: var(--value-box-width);
            margin-top: 8px;
            padding: var(--ui-padding-tiny);
            text-align: center;
            font-size: 11px;
            border: none; /* REMOVED: Clean padding-only design */
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.9); /* Subtle background for definition */
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); /* Gentle shadow for depth */
        }

        /* Button styling (reusable) - Updated to match original .button design */
        .grid-mode-button {
            height: 18px;
            padding: 4px 8px;
            font-size: 10px;
            font-weight: 600;
            border: none;
            border-radius: 6px;
            background: linear-gradient(45deg, rgba(158, 158, 158, 0.8), rgba(117, 117, 117, 0.8));
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .grid-mode-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(158, 158, 158, 0.4);
        }

        .grid-mode-button.state-primary {
            background: linear-gradient(45deg, rgba(76, 175, 80, 0.8), rgba(69, 160, 73, 0.8));
            color: white;
        }

        .grid-mode-button.state-primary:hover {
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        /* Horizontal slider styling (reusable) */
        .grid-horizontal-slider {
            width: 100%;
            height: 20px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.1);
            outline: none;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .grid-horizontal-slider:hover {
            opacity: 1;
        }

        /* =============================================================================
         * RESPONSIVE ADAPTATIONS
         * =============================================================================
         */

        @media (max-width: 1200px) {
            :root {
                --lighting-panel-width: 270px;
                --sun-control-width: 110px;
                --outer-margin: 12px; /* REDUCED: Smaller margin for medium screens */
            }
            
            .lighting-title,
            .lighting-ambient-label {
                font-size: 11px;
            }
            
            .grid-mode-button {
                font-size: 9px;
                height: 16px;
                padding: 3px 6px;
            }
        }

        @media (max-width: 768px) {
            :root {
                --lighting-panel-width: 250px;
                --sun-control-width: 100px;
                --value-box-width: 40px;
                --outer-margin: 10px; /* REDUCED: Even smaller margin for small screens */
            }
            
            .grid-vertical-slider {
                height: 120px;
            }
            
            .lighting-sun-control {
                height: 120px;
            }
        }